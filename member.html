<!-- member.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Member Profile</title>
  <link rel="stylesheet" href="style.css" />
</head>
<!--Start of Tawk.to Script-->
<script type="text/javascript">
var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
(function(){
var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
s1.async=true;
s1.src='https://embed.tawk.to/685f752a3819e5190c8b7260/1iuqe3c29';
s1.charset='UTF-8';
s1.setAttribute('crossorigin','*');
s0.parentNode.insertBefore(s1,s0);
})();
</script>
<!--End of Tawk.to Script-->

<body>
<!-- DROPDOWN -->
<div class="dropdown" id="profileMenu">
  <button class="dropdown-btn" onclick="toggleMenu()">Admin&nbsp;Menu ▾</button>

  <div class="dropdown-content">
   <a href="#" onclick="openModal(); return false;">Go to Admin Profile</a>
   <a href="contributions.html">View Contributions</a>


    <!-- add more menu items here if needed -->
  </div>
</div>

  <section class="slide">
    <img src="images/member1.png">
     <div class="profile-info">
    <h1>Member Profile</h1>

    <dl class="profile-grid">
      <dt>Name</dt>      <dd>Solina Levy Cohen</dd>
      <dt>Email</dt>     <dd>solinacohen4@gmail.com</dd>
      <dt>Address</dt>   <dd>28947 Thousand Oaks Blvd Unit 224<br>Agoura Hills 91301</dd>
      <dt>Date of Birth</dt> <dd>25 Nov 1964</dd>
      <dt>Account No.</dt>   <dd>001-235678-04</dd>
      <dt>Status</dt>        <dd>Active ✓</dd>
    </dl>
  </div>
  </section>
  <div class="dashboard">

  <!-- Account Summary -->
  <section class="card">
    <h2>Account Summary</h2>
    <div class="balance">$ 500.00</div>
    <p class="small">Savings • ****5678</p>
    <p class="small">Interest rate: 5.00 % p.a.</p>
  </section>

  <!-- Recent Transactions -->
  <section class="card">
    <h2>Recent Transactions</h2>
    <ul class="txn-list">
      <li class="txn out">
        <span class="label">
          <span class="icon">⬆</span> Amount
        </span>
        <span class="amount">- $500.00</span>
      </li>
      <li class="txn date">
        <span class="label">
          <span class="icon">⬇</span> Date
        </span>
        <span class="amount">July 28th 2025</span>
      </li>
      <li class="txn desc">
        <span class="label">
          <span class="icon">ℹ</span> Purpose
        </span>
        <span class="amount">Housing</span>
      </li>
      <li class="txn interest">
        <span class="label">
          <span class="icon">👤</span> Interest (5%)
        </span>
        <span class="amount">$25.00</span>
      </li>
      <li class="txn total">
        <span class="label">
          <span class="icon">💰</span> Total Balance
        </span>
        <span class="amount">$525.00</span>

    </ul>
  </section>

  <!-- Contact & Security -->
  <section class="card">
    <h2>Contact &amp; Security</h2>
    <p class="small"><strong>Last login:</strong> -</p>
    <p class="small"><strong>2-FA:</strong> Disabled</p>
    <a href="payment.html" class="btn">Update details</a>
    <a href="customer-service.html" class="btn" style="margin-left:0.5rem;">Manage security</a>
    <a href="All.html" class="btn">View All Transactions</a>
  </section>

</div>

<section class="card">
  <h2>Monthly Savings Tracker (July 2025 – June 2026)</h2>
  
  <!-- Quick Action Button -->
  <div style="margin-bottom: 15px; text-align: center;">
    <button id="markCurrentMonthBtn" class="btn" onclick="markCurrentMonth()" 
            style="background: #22c55e; color: white; padding: 8px 16px; border: none; border-radius: 6px; font-weight: 500;">
      💰 Mark Current Month as Paid
    </button>
    <p id="currentMonthInfo" style="margin: 5px 0; font-size: 14px; color: #666;"></p>
  </div>
  
  <table style="width:100%; text-align:left; border-collapse:collapse;">
    <thead>
      <tr>
        <th>Month</th>
        <th>Due Date</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody id="calendarBody">
      <!-- Populated by script -->
    </tbody>
  </table>
</section>

<style>
  .calendar-check {
    padding: 4px 10px;
    border: 1px solid #cbd5e1;
    border-radius: 6px;
    font-weight: 500;
  }
  .calendar-check.paid {
    background: #22c55e;
    color: #fff;
    border-color: #16a34a;
  }
</style>

<script>
  const months = [
    'July 2025', 'August 2025', 'September 2025', 'October 2025',
    'November 2025', 'December 2025', 'January 2026', 'February 2026',
    'March 2026', 'April 2026', 'May 2026', 'June 2026'
  ];

  const $cal = document.getElementById('calendarBody');

  // Function to get calendar status from API
  function getStatus() {
    const xhr = new XMLHttpRequest();
    xhr.open('GET', 'calendar-api.html?action=get', false);  // Synchronous request
    xhr.send();
    
    if (xhr.status === 200) {
      try {
        const response = JSON.parse(xhr.responseText);
        return response.success ? response.paidMonths : [];
      } catch (e) {
        return [];
      }
    }
    return [];
  }

  function renderCalendar() {
    const status = getStatus();
    $cal.innerHTML = '';

    months.forEach((month, i) => {
      const paid = status.includes(i);
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${month}</td>
        <td>28th</td>
        <td>
          <button class="calendar-check ${paid ? 'paid' : ''}" onclick="toggleMonth(${i})">
            ${paid ? '✔ Paid' : 'Mark as Paid'}
          </button>
        </td>
      `;
      $cal.appendChild(row);
    });
    
    // Update the current month info
    updateCurrentMonthInfo();
  }

  function getCurrentMonthIndex() {
    const now = new Date();
    const currentYear = now.getFullYear();
    const currentMonth = now.getMonth(); // 0-11
    
    // The savings tracker runs from July 2025 to June 2026
    // July 2025 = index 0, August 2025 = index 1, etc.
    
    if (currentYear === 2025) {
      // July 2025 (month 6) to December 2025 (month 11)
      if (currentMonth >= 6) { // July is month 6
        return currentMonth - 6; // July=0, Aug=1, Sep=2, Oct=3, Nov=4, Dec=5
      }
    } else if (currentYear === 2026) {
      // January 2026 (month 0) to June 2026 (month 5)
      if (currentMonth <= 5) { // June is month 5
        return currentMonth + 6; // Jan=6, Feb=7, Mar=8, Apr=9, May=10, Jun=11
      }
    }
    
    return -1; // Outside the tracking period
  }

  function updateCurrentMonthInfo() {
    const currentIndex = getCurrentMonthIndex();
    const infoElement = document.getElementById('currentMonthInfo');
    const buttonElement = document.getElementById('markCurrentMonthBtn');
    
    if (currentIndex === -1) {
      infoElement.textContent = 'Current date is outside the tracking period (July 2025 - June 2026)';
      buttonElement.disabled = true;
      buttonElement.style.opacity = '0.5';
    } else {
      const currentMonthName = months[currentIndex];
      const status = getStatus();
      const isPaid = status.includes(currentIndex);
      
      if (isPaid) {
        infoElement.textContent = `${currentMonthName} is already marked as paid ✓`;
        buttonElement.textContent = '✓ Current Month Already Paid';
        buttonElement.style.background = '#16a34a';
      } else {
        infoElement.textContent = `Ready to mark ${currentMonthName} as paid`;
        buttonElement.textContent = '💰 Mark Current Month as Paid';
        buttonElement.style.background = '#22c55e';
      }
      
      buttonElement.disabled = false;
      buttonElement.style.opacity = '1';
    }
  }

  function markCurrentMonth() {
    const currentIndex = getCurrentMonthIndex();
    
    if (currentIndex === -1) {
      alert('Current date is outside the tracking period (July 2025 - June 2026)');
      return;
    }
    
    const status = getStatus();
    const isPaid = status.includes(currentIndex);
    
    if (isPaid) {
      const confirmUnmark = confirm(`${months[currentIndex]} is already marked as paid. Do you want to unmark it?`);
      if (!confirmUnmark) return;
    }
    
    // Use the existing toggleMonth function
    toggleMonth(currentIndex);
  }

  function toggleMonth(monthIndex) {
    // Show loading state
    const button = event.target;
    const originalText = button.textContent;
    button.textContent = 'Updating...';
    button.disabled = true;
    
    // Make API call to toggle month
    const xhr = new XMLHttpRequest();
    xhr.open('GET', `calendar-api.html?action=toggle&month=${monthIndex}`, false);
    xhr.send();
    
    // Reset button state
    button.disabled = false;
    
    if (xhr.status === 200) {
      try {
        const response = JSON.parse(xhr.responseText);
        if (response.success) {
          // Re-render the calendar with updated data
          renderCalendar();
        } else {
          alert('Failed to update: ' + response.message);
          button.textContent = originalText;
        }
      } catch (e) {
        alert('Error updating calendar');
        button.textContent = originalText;
      }
    } else {
      alert('Network error');
      button.textContent = originalText;
    }
  }

  renderCalendar();
</script>

   
    <section class="slide">
    <img src="images/footer.png">
    <script>
function toggleMenu() {
  document.getElementById('profileMenu').classList.toggle('open');
}
/* optional: close menu when you click anywhere else */
document.addEventListener('click', (e)=>{
  const menu = document.getElementById('profileMenu');
  if (!menu.contains(e.target)) menu.classList.remove('open');
});
</script>

  </section>
  <!-- ── Admin Access Modal ─────────────────────────────────── -->
<div class="modal-overlay" id="verifyModal" aria-hidden="true">
  <div class="modal-box">
    <h2>Admin Access</h2>
    <p>Please enter your 4-digit access code.</p>

    <input id="accessCode" type="password" maxlength="4" pattern="\d{4}"
           autocomplete="one-time-code" autofocus />

    <p id="verifyError" class="error-msg">Wrong code. Try again.</p>

    <div class="modal-actions">
      <button class="btn" onclick="handleVerify()">Verify</button>
      <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
    </div>
  </div>
</div>

<script>
/* ─── Config ─────────────────────────── */
const ACCESS_CODE = '2468';   // ← change to whatever code you want

/* ─── Modal helpers ──────────────────── */
function openModal(){
  document.getElementById('verifyModal').classList.add('show');
  document.getElementById('accessCode').value='';
  document.getElementById('verifyError').style.display='none';
  setTimeout(()=>document.getElementById('accessCode').focus(),100);
}

function closeModal(){
  document.getElementById('verifyModal').classList.remove('show');
}

function handleVerify(){
  const input = document.getElementById('accessCode').value.trim();
  if(input === ACCESS_CODE){
    window.location.href='admin.html';
  }else{
    const box = document.querySelector('.modal-box');
    box.classList.add('shake');
    document.getElementById('verifyError').style.display='block';
    setTimeout(()=>box.classList.remove('shake'), 350);
  }
}

/* ─── Hook dropdown link → openModal() ────────────────── */
/* Replace the plain anchor tag inside your dropdown with: */
</script>


</body>
</html>
